---
#
custom_card_mushroom_climate:
  template: setup
  variables:
    sensor: test
  icon: |
    [[[
      if (entity.attributes.current_humidity > "70") return "mdi:water-percent";
      else if (entity.state == "auto") return "mdi:thermostat-auto";
      else if (entity.state == "heat") return "mdi:fire";
      else return "mdi:thermostat";
    ]]]
  show_label: true
  tap_action:
    action: more-info
    haptic: success
  double_tap_action:
    action: call-service
    service: climate.set_hvac_mode
    data:
      hvac_mode: auto
    target:
      entity_id: "[[[ return entity.entity_id ]]]"
  hold_action:
    action: more-info
  custom_fields:
    temp:
      card:
        type: custom:button-card
        entity: "[[[return entity.entity_id ]]]"
        show_label: true
        show_name: false
        show_icon: false
        label: "[[[return states[ entity.entity_id ].attributes.temperature ]]]"
        custom_fields:
          minus:
            card:
              type: custom:button-card
              icon: mdi:minus
              styles:
                icon:
                  - width: 20px
                card:
                  - box-shadow: none
                  - background: none
              tap_action:
                action: call-service
                service: climate.set_temperature
                data:
                  temperature: |
                    [[[
                      return states[entity.entity_id].attributes.temperature - 0.5;
                    ]]]
                target:
                  entity_id: "[[[ return entity.entity_id ]]]"
          plus:
            card:
              type: custom:button-card
              icon: mdi:plus
              styles:
                icon:
                  - width: 20px
                card:
                  - box-shadow: none
                  - background: none
              tap_action:
                action: call-service
                service: climate.set_temperature
                data:
                  temperature: |
                    [[[
                      return states[entity.entity_id].attributes.temperature + 0.5;
                    ]]]
                target:
                  entity_id: "[[[ return entity.entity_id ]]]"
        styles:
          grid:
            - grid-template-areas: |
                'minus l plus'
            - grid-template-columns: 50px 1fr 50px
          card:
            - background-color: var(--contrast4)
            - padding: 5px
            - border-radius: 12px
            - height: 35px
          label:
            - font-weight: 500
            - font-size: 14px
    window:
      card:
        type: custom:button-card
        entity: "[[[return variables.sensor ]]]"
        show_name: false
        icon: mdi:window-closed-variant
        state:
          - value: "on"
            icon: mdi:window-open-variant
            styles:
              icon:
                - color: var(--red)
        styles:
          card:
            - background: none
            - box-shadow: none
            - padding: 5px
          img_cell:
            - width: 35px
            - height: 35px
            - background-color: var(--contrast4)
            - border-radius: 12px
            - justify-content: center
          icon:
            - width: 18px
            - justify-self: center
            - align-self: center
            - color: var(--contrast16)
    auto:
      card:
        type: custom:button-card
        entity: "[[[ return entity.entity_id ]]]"
        show_name: false
        icon: mdi:thermostat-auto
        tap_action:
          action: call-service
          service: climate.set_hvac_mode
          data:
            hvac_mode: auto
          target:
            entity_id: "[[[ return entity.entity_id ]]]"
        styles:
          card:
            - background: none
            - box-shadow: none
            - padding: 5px
          img_cell:
            - width: 35px
            - height: 35px
            - background-color: var(--contrast4)
            - border-radius: 12px
            - justify-content: center
          icon:
            - width: 18px
            - justify-self: center
            - align-self: center
            - color: |
                [[[
                  if (entity.state == "auto") return "var(--green)";
                  else return "var(--contrast12)";
                ]]]
  styles:
    grid:
      - grid-template-areas: |
          'i n window'
          'i l window'
          'temp temp auto'
      - grid-template-columns: 50px 1fr 50px
      - grid-template-rows: min-content min-content min-content
    img_cell:
      - width: 40px
      - height: 40px
      - background-color: var(--contrast4)
      - border-radius: 12px
      - justify-content: center
    icon:
      - width: 24px
      - justify-self: center
      - align-self: center
      - color: |
          [[[
            if (entity.attributes.current_humidity > "70") return "var(--red)";
            else if (entity.state == "auto") return "var(--green)";
            else if (entity.state == "heat") return "var(--red)";
            else return "var(--contrast10)";
          ]]]
    card:
      - background-color: var(--contrast2)
      - box-shadow: none
      - border-radius: 24px
      - padding: 12px 12px 12px 12px
      - z-index: 1
    name:
      - justify-self: start
      - align-self: end
      - color: var(--contrast20)
      - font-size: 13px
      - font-weight: 600
      - margin-bottom: 0px
      - padding-left: 3px
    label:
      - justify-self: start
      - align-self: center
      - color: var(--contrast16)
      - font-size: 12px
      - font-weight: 400
      - padding-left: 3px
    custom_fields:
      window:
        - justify-self: end
      auto:
        - justify-self: end
